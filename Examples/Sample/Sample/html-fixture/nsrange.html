<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>
      NSRange : NSHipster
    </title>
    <meta name="description" content=
    "NSHipster is a journal of the overlooked bits in Objective-C and Cocoa. Updated weekly.">
    <meta name="author" content="Mattt Thompson">
    <meta name="revisit-after" content="3 days">
    <meta name="viewport" content="width=device-width">
    <link rel="license" href=
    "http://creativecommons.org/licenses/by-nc/3.0/">
    <link rel="alternate" hreflang="en-us" href=
    "http://nshipster.com">
    <link rel="alternate" hreflang="zh-Hans" href=
    "http://nshipster.cn">
    <link rel="alternate" hreflang="x-default" href=
    "http://nshipster.com">
    <link rel="alternate" type="application/rss+xml" title="RSS"
    href="http://nshipster.com/feed.xml">
    <link rel="stylesheet" href="/css/screen.css" type="text/css">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@NSHipster">
    <meta name="twitter:creator" content="@mattt">
    <meta name="twitter:title" content="NSRange">
    <meta name="twitter:description" content=
    "NSRange is one of the essential types of Foundation. Passed around and returned in methods throughout the framework, being well-versed in this struct has a range of benefits.">
    <meta content="NSHipster" property="og:site_name">
    <meta content="NSRange" property="og:title">
    <meta content="http://nshipster.com/nsrange/" property=
    "og:url">
    <meta content=
    "NSRange is one of the essential types of Foundation. Passed around and returned in methods throughout the framework, being well-versed in this struct has a range of benefits."
    property="og:description">
    <meta property="st:title" content="NSRange">
    <meta property="st:type" content="article">
    <script type="text/javascript">
var _sf_startpt=(new Date()).getTime()
    </script>
    <script onload="try{Typekit.load();}catch(e){}" src=
    "//use.typekit.net/agk0bgp.js" type="text/javascript">
</script>
  </head>
  <body>
    <div role="container">
      <header role="banner">
        <h1 id="logo">
          <a href="/"><acronym title="NeXTSTEP/Sun">NS</acronym>
          <strong>Hipster</strong> <img id="moustache" src=
          "//cdn.nshipster.com/images/moustache.svg" width="200"
          height="150" data-author=
          "http://thenounproject.com/bnhw"></a>
        </h1>
        <form>
          <input type="text" id="st-search-input" class=
          "st-search-input">
        </form>
      </header>
      <div id="main" role="main">
        <article>
          <header>
            <h1>
              <a href="/nsrange/">NSRange</a>
            </h1>
            <h2>
              Written by <a href="http://mattt.me/">Mattt
              Thompson</a> on <time pubdate=
              "2014-01-13 00:00:00 -0800">Jan 13<span>th</span>,
              2014</time>
            </h2>
          </header>
          <div class="content" data-swiftype-index="true">
            <p>
              <code>NSRange</code> is one of the essential types of
              Foundation. Passed around and returned in methods
              throughout the framework, being well-versed in this
              struct has a range of benefits, which this week's
              article will help you locate.
            </p>
            <hr>
            <p>
              Ranges are data types used to describe a contiguous
              interval of integers. They are most commonly used
              with strings, arrays, and similarly-ordered
              collections.
            </p>
            <p>
              For Objective-C programs, the Foundation type
              <code>NSRange</code> is used. In other languages,
              ranges are often encoded as a two-element array,
              containing the start and end indexes. In Foundation,
              <code>NSRange</code> instead encodes a range as
              struct containing the location and length. By
              command-clicking (<code>⌘-ʘ</code>) on the
              <code>NSRange</code> symbol in Xcode, we can jump
              directly to its declaration in
              <code>Foundation/NSRange.h</code>:
            </p>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="k">typedef</span> <span class=
"k">struct</span> <span class="n">_NSRange</span> <span class=
"p">{</span>
    <span class="n">NSUInteger</span> <span class=
"n">location</span><span class="p">;</span>
    <span class="n">NSUInteger</span> <span class=
"n">length</span><span class="p">;</span>
<span class="p">}</span> <span class="n">NSRange</span><span class=
"p">;</span>
</code>
</pre>
            </div>
            <p>
              In practice, this approach helps mitigate common
              off-by-one errors when working with ranges. For
              example, compare the equivalent Javascript and
              Objective-C code for creating a range of characters
              for a given string:
            </p>
            <h4>
              range.js
            </h4>
            <div class="highlight">
              <pre>
<code class="javascript language-javascript" data-lang=
"javascript"><span class="kd">var</span> <span class=
"nx">string</span> <span class="o">=</span> <span class=
"s2">"hello, world"</span><span class="p">;</span>
<span class="kd">var</span> <span class=
"nx">range</span> <span class="o">=</span> <span class=
"p">[</span><span class="mi">0</span><span class=
"p">,</span> <span class="nx">string</span><span class=
"p">.</span><span class="nx">length</span> <span class=
"o">-</span> <span class="mi">1</span><span class="p">];</span>
</code>
</pre>
            </div>
            <p>
              Forgetting to subtract <code>1</code> for the end
              index in Javascript would result in an out-of-bounds
              error later.
            </p>
            <h4>
              range.m
            </h4>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSString</span> <span class=
"o">*</span><span class="n">string</span> <span class=
"o">=</span> <span class="s">@"hello, world"</span><span class=
"p">;</span>
<span class="n">NSRange</span> <span class=
"n">range</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">0</span><span class="p">,</span> <span class=
"p">[</span><span class="n">string</span> <span class=
"n">length</span><span class="p">]);</span>
</code>
</pre>
            </div>
            <p>
              <code>NSRange</code>'s approach is clearer and less
              prone to error—especially when it comes to more
              complex arithmetic operations on ranges.
            </p>
            <h2>
              Usage
            </h2>
            <h3>
              Strings
            </h3>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSString</span> <span class=
"o">*</span><span class="n">string</span> <span class=
"o">=</span> <span class=
"s">@"lorem ipsum dolor sit amet"</span><span class="p">;</span>
<span class="n">NSRange</span> <span class=
"n">range</span> <span class="o">=</span> <span class=
"p">[</span><span class="n">string</span> <span class=
"n">rangeOfString</span><span class="o">:</span><span class=
"s">@"ipsum"</span><span class="p">];</span>
<span class="c1">// {.location=6, .length=5}</span>

<span class="n">NSString</span> <span class=
"o">*</span><span class="n">substring</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">string</span> <span class=
"n">substringWithRange</span><span class="o">:</span><span class=
"n">range</span><span class="p">];</span>
<span class="c1">// @"ipsum"</span>
</code>
</pre>
            </div>
            <p>
              <code>NSString</code> does not have a method like
              <code>containsString:</code>. Instead,
              <code>rangeOfString:</code> can be used to check for
              an <code>NSNotFound</code> location value:
            </p>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSString</span> <span class=
"o">*</span><span class="n">input</span> <span class=
"o">=</span> <span class="p">...;</span>
<span class="k">if</span> <span class="p">([</span><span class=
"n">input</span> <span class="n">rangeOfString</span><span class=
"o">:</span><span class="s">@"keyword"</span><span class=
"p">].</span><span class="n">location</span> <span class=
"o">!=</span> <span class="n">NSNotFound</span><span class=
"p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</code>
</pre>
            </div>
            <h3>
              Arrays
            </h3>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSArray</span> <span class=
"o">*</span><span class="n">array</span> <span class=
"o">=</span> <span class="p">@[</span><span class=
"s">@"a"</span><span class="p">,</span> <span class=
"s">@"b"</span><span class="p">,</span> <span class=
"s">@"c"</span><span class="p">,</span> <span class=
"s">@"d"</span><span class="p">];</span>
<span class="n">NSArray</span> <span class="o">*</span><span class=
"n">subarray</span> <span class="o">=</span> <span class=
"p">[</span><span class="n">array</span> <span class=
"n">subarrayWithRange</span><span class="o">:</span><span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">1</span><span class="p">,</span> <span class=
"mi">2</span><span class="p">)];</span>
<span class="c1">// @[@"b", @"c"]</span>
</code>
</pre>
            </div>
            <h3>
              Index Sets
            </h3>
            <p>
              <a href=
              "http://nshipster.com/nsindexset/">NSIndexSet</a> is
              a Foundation collection class that is similar to
              <code>NSRange</code>, with the notable exception of
              being able to support non-contiguous series. An
              <code>NSIndexSet</code> can be created from a range
              using the <code>indexSetWithIndexesInRange:</code>
              class constructor:
            </p>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSRange</span> <span class=
"n">range</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">0</span><span class="p">,</span> <span class=
"mi">10</span><span class="p">);</span>
<span class="n">NSIndexSet</span> <span class=
"o">*</span><span class="n">indexSet</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSIndexSet</span> <span class=
"n">indexSetWithIndexesInRange</span><span class=
"o">:</span><span class="n">range</span><span class="p">];</span>
</code>
</pre>
            </div>
            <h2>
              Functions
            </h2>
            <p>
              Because <code>NSRange</code> is not a class, creating
              and using instances is done through function calls,
              rather than, say, instance methods.
            </p>
            <blockquote>
              <p>
                Many of the NSRange functions are named counter to
                the modern conventions of Foundation and
                CoreFoundation wherein the relevant type of the
                function immediately follows the two-letter
                namespace. For example, <code>NSMakeRange</code>
                should instead be named <code>NSRangeMake</code>,
                following the example of <code>CGRectMake</code>
                and <code>CGSizeMake</code>, et al. Similarly, a
                better name for <code>NSEqualRanges</code> would be
                <code>NSRangeEqualToRange</code>, just like
                <code>CGPointEqualToPoint</code>.
              </p>
              <p>
                Although consistency in itself is likely not
                sufficient reason to go through the trouble of
                replacing existing usage, <a href=
                "https://gist.github.com/mattt/8402537">this
                gist</a> shows how one could make their own code
                base a little more OCD-friendly.
              </p>
            </blockquote>
            <h3>
              Creating an NSRange
            </h3>
            <blockquote>
              <ul>
                <li>
                  <code>NSMakeRange</code>: Creates a new NSRange
                  from the specified values.
                </li>
              </ul>
            </blockquote>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSArray</span> <span class=
"o">*</span><span class="n">array</span> <span class=
"o">=</span> <span class="p">@[</span><span class=
"mi">@1</span><span class="p">,</span> <span class=
"mi">@2</span><span class="p">,</span> <span class=
"mi">@3</span><span class="p">];</span>
<span class="n">NSRange</span> <span class=
"n">range</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">0</span><span class="p">,</span> <span class=
"p">[</span><span class="n">array</span> <span class=
"n">count</span><span class="p">]);</span>
<span class="c1">// {.location=0, .length=3}</span>
</code>
</pre>
            </div>
            <h3>
              Querying Information
            </h3>
            <blockquote>
              <ul>
                <li>
                  <code>NSEqualRanges</code>: Returns a Boolean
                  value that indicates whether two given ranges are
                  equal.
                </li>
              </ul>
            </blockquote>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSRange</span> <span class=
"n">range1</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">0</span><span class="p">,</span> <span class=
"mi">6</span><span class="p">);</span>
<span class="n">NSRange</span> <span class=
"n">range2</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">2</span><span class="p">,</span> <span class=
"mi">7</span><span class="p">);</span>
<span class="kt">BOOL</span> <span class=
"n">equal</span> <span class="o">=</span> <span class=
"n">NSEqualRanges</span><span class="p">(</span><span class=
"n">range1</span><span class="p">,</span> <span class=
"n">range2</span><span class="p">);</span> <span class=
"c1">// NO</span>
</code>
</pre>
            </div>
            <blockquote>
              <ul>
                <li>
                  <code>NSLocationInRange</code>: Returns a Boolean
                  value that indicates whether a specified position
                  is in a given range.
                </li>
              </ul>
            </blockquote>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSRange</span> <span class=
"n">range</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">3</span><span class="p">,</span> <span class=
"mi">4</span><span class="p">);</span>
<span class="kt">BOOL</span> <span class=
"n">contained</span> <span class="o">=</span> <span class=
"n">NSLocationInRange</span><span class="p">(</span><span class=
"mi">5</span><span class="p">,</span> <span class=
"n">range</span><span class="p">);</span> <span class=
"c1">// YES</span>
</code>
</pre>
            </div>
            <blockquote>
              <ul>
                <li>
                  <code>NSMaxRange</code>: Returns the sum of the
                  location and length of the range.
                </li>
              </ul>
            </blockquote>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSRange</span> <span class=
"n">range</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">3</span><span class="p">,</span> <span class=
"mi">4</span><span class="p">);</span>
<span class="n">NSUInteger</span> <span class=
"n">max</span> <span class="o">=</span> <span class=
"n">NSMaxRange</span><span class="p">(</span><span class=
"n">range</span><span class="p">);</span> <span class=
"c1">// 7</span>
</code>
</pre>
            </div>
            <h3>
              Set Operations
            </h3>
            <blockquote>
              <ul>
                <li>
                  <code>NSIntersectionRange</code>: Returns the
                  intersection of the specified ranges. If the
                  returned range’s length field is <code>0</code>,
                  then the two ranges don’t intersect, and the
                  value of the location field is undefined.
                </li>
              </ul>
            </blockquote>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSRange</span> <span class=
"n">range1</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">0</span><span class="p">,</span> <span class=
"mi">6</span><span class="p">);</span>
<span class="n">NSRange</span> <span class=
"n">range2</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">2</span><span class="p">,</span> <span class=
"mi">7</span><span class="p">);</span>
<span class="n">NSRange</span> <span class=
"n">intersectionRange</span> <span class="o">=</span> <span class=
"n">NSIntersectionRange</span><span class="p">(</span><span class=
"n">range1</span><span class="p">,</span> <span class=
"n">range2</span><span class="p">);</span>
<span class="c1">// {.location=2, .length=4}</span>
</code>
</pre>
            </div>
            <blockquote>
              <ul>
                <li>
                  <code>NSUnionRange</code>: Returns the union of
                  the specified ranges. A range covering all
                  indices in and between range1 and range2. If one
                  range is completely contained in the other, the
                  returned range is equal to the larger range.
                </li>
              </ul>
            </blockquote>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSRange</span> <span class=
"n">range1</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">0</span><span class="p">,</span> <span class=
"mi">6</span><span class="p">);</span>
<span class="n">NSRange</span> <span class=
"n">range2</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">2</span><span class="p">,</span> <span class=
"mi">7</span><span class="p">);</span>
<span class="n">NSRange</span> <span class=
"n">unionRange</span> <span class="o">=</span> <span class=
"n">NSUnionRange</span><span class="p">(</span><span class=
"n">range1</span><span class="p">,</span> <span class=
"n">range2</span><span class="p">);</span>
<span class="c1">// {.location=0, .length=9}</span>
</code>
</pre>
            </div>
            <h3>
              Converting Between NSString * &amp; NSRange
            </h3>
            <blockquote>
              <ul>
                <li>
                  <code>NSStringFromRange</code>: Returns a string
                  representation of a range.
                </li>
              </ul>
            </blockquote>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSRange</span> <span class=
"n">range</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">3</span><span class="p">,</span> <span class=
"mi">4</span><span class="p">);</span>
<span class="n">NSString</span> <span class=
"o">*</span><span class="n">string</span> <span class=
"o">=</span> <span class="n">NSStringFromRange</span><span class=
"p">(</span><span class="n">range</span><span class=
"p">);</span> <span class="c1">// @"{3,4}"</span>
</code>
</pre>
            </div>
            <blockquote>
              <ul>
                <li>
                  <code>NSRangeFromString</code>: Returns a range
                  from a textual representation.
                </li>
              </ul>
            </blockquote>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSString</span> <span class=
"o">*</span><span class="n">string</span> <span class=
"o">=</span> <span class="s">@"{1,5}"</span><span class=
"p">;</span>
<span class="n">NSRange</span> <span class=
"n">range</span> <span class="o">=</span> <span class=
"n">NSRangeFromString</span><span class="p">(</span><span class=
"n">string</span><span class="p">);</span>
<span class="c1">// {.location=1, .length=5}</span>
</code>
</pre>
            </div>
            <p>
              If the string passed into
              <code>NSRangeFromString</code> does not represent a
              valid range, it will return a range with its location
              and length set to <code>0</code>.
            </p>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSString</span> <span class=
"o">*</span><span class="n">string</span> <span class=
"o">=</span> <span class="s">@"invalid"</span><span class=
"p">;</span>
<span class="n">NSRange</span> <span class=
"n">range</span> <span class="o">=</span> <span class=
"n">NSRangeFromString</span><span class="p">(</span><span class=
"n">string</span><span class="p">);</span>
<span class="c1">// {.location=0, .length=0}</span>
</code>
</pre>
            </div>
            <p>
              While one might be tempted to use
              <code>NSStringFromRange</code> to box
              <code>NSRange</code> for inclusion within an
              <code>NSArray</code>, <code>NSValue
              +valueWithRange:</code> is the way to go:
            </p>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSRange</span> <span class=
"n">range</span> <span class="o">=</span> <span class=
"n">NSMakeRange</span><span class="p">(</span><span class=
"mi">0</span><span class="p">,</span> <span class=
"mi">3</span><span class="p">);</span>
<span class="n">NSValue</span> <span class="o">*</span><span class=
"n">value</span> <span class="o">=</span> <span class=
"p">[</span><span class="n">NSValue</span> <span class=
"n">valueWithRange</span><span class="o">:</span><span class=
"n">range</span><span class="p">];</span>
</code>
</pre>
            </div>
            <hr>
            <p>
              <code>NSRange</code> is one of the few cases where
              some of the underlying implementation of its
              functions are actually exposed and inlined in the
              public headers:
            </p>
            <h4>
              Foundation/NSRange.h
            </h4>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NS_INLINE</span> <span class=
"n">NSRange</span> <span class="nf">NSMakeRange</span><span class=
"p">(</span><span class="n">NSUInteger</span> <span class=
"n">loc</span><span class="p">,</span> <span class=
"n">NSUInteger</span> <span class="n">len</span><span class=
"p">)</span> <span class="p">{</span>
    <span class="n">NSRange</span> <span class=
"n">r</span><span class="p">;</span>
    <span class="n">r</span><span class="p">.</span><span class=
"n">location</span> <span class="o">=</span> <span class=
"n">loc</span><span class="p">;</span>
    <span class="n">r</span><span class="p">.</span><span class=
"n">length</span> <span class="o">=</span> <span class=
"n">len</span><span class="p">;</span>
    <span class="k">return</span> <span class=
"n">r</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">NS_INLINE</span> <span class=
"n">NSUInteger</span> <span class=
"nf">NSMaxRange</span><span class="p">(</span><span class=
"n">NSRange</span> <span class="n">range</span><span class=
"p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class=
"p">(</span><span class="n">range</span><span class=
"p">.</span><span class="n">location</span> <span class=
"o">+</span> <span class="n">range</span><span class=
"p">.</span><span class="n">length</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">NS_INLINE</span> <span class=
"kt">BOOL</span> <span class=
"nf">NSLocationInRange</span><span class="p">(</span><span class=
"n">NSUInteger</span> <span class="n">loc</span><span class=
"p">,</span> <span class="n">NSRange</span> <span class=
"n">range</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class=
"p">(</span><span class="o">!</span><span class=
"p">(</span><span class="n">loc</span> <span class=
"o">&lt;</span> <span class="n">range</span><span class=
"p">.</span><span class="n">location</span><span class=
"p">)</span> <span class="o">&amp;&amp;</span> <span class=
"p">(</span><span class="n">loc</span> <span class=
"o">-</span> <span class="n">range</span><span class=
"p">.</span><span class="n">location</span><span class=
"p">)</span> <span class="o">&lt;</span> <span class=
"n">range</span><span class="p">.</span><span class=
"n">length</span><span class="p">)</span> <span class=
"o">?</span> <span class="nb">YES</span> <span class=
"o">:</span> <span class="nb">NO</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">NS_INLINE</span> <span class=
"kt">BOOL</span> <span class="nf">NSEqualRanges</span><span class=
"p">(</span><span class="n">NSRange</span> <span class=
"n">range1</span><span class="p">,</span> <span class=
"n">NSRange</span> <span class="n">range2</span><span class=
"p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class=
"p">(</span><span class="n">range1</span><span class=
"p">.</span><span class="n">location</span> <span class=
"o">==</span> <span class="n">range2</span><span class=
"p">.</span><span class="n">location</span> <span class=
"o">&amp;&amp;</span> <span class="n">range1</span><span class=
"p">.</span><span class="n">length</span> <span class=
"o">==</span> <span class="n">range2</span><span class=
"p">.</span><span class="n">length</span><span class="p">);</span>
<span class="p">}</span>
</code>
</pre>
            </div>
            <h2>
              NSRangePointer
            </h2>
            <p>
              One oddity worth mentioning with <code>NSRange</code>
              is the existence of <code>NSRangePointer</code>.
              "What the what?", you might exclaim in panicked
              confusion. Jumping to the source confirms our darkest
              fears:
            </p>
            <h4>
              Foundation/NSRange.h
            </h4>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="k">typedef</span> <span class=
"n">NSRange</span> <span class="o">*</span><span class=
"n">NSRangePointer</span><span class="p">;</span>
</code>
</pre>
            </div>
            <p>
              So. Without a definitive origin story, one would have
              to assume that this type was created by a
              well-meaning framework engineer who noted the
              confusion around <code>NSRange</code> being a struct
              and not a class. <code>NSRange *</code> is equivalent
              to <code>NSRangePointer</code>, though the latter can
              be found in out parameters for various methods
              throughout Foundation.
              <code>NSAttributedString</code>, for instance, has an
              <code>NSRangePointer</code> parameter for returning
              the effective range of an attribute at a particular
              index (since the attribute likely starts and ends
              before outside of the specified index):
            </p>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class=
"n">NSMutableAttributedString</span> <span class=
"o">*</span><span class=
"n">mutableAttributedString</span> <span class=
"o">=</span> <span class="p">...;</span>
<span class="n">NSRange</span> <span class=
"n">range</span><span class="p">;</span>
<span class="k">if</span> <span class="p">([</span><span class=
"n">mutableAttributedString</span> <span class=
"n">attribute</span><span class="o">:</span><span class=
"n">NSUnderlineStyleAttributeName</span>
                               <span class=
"nl">atIndex:</span><span class="mi">0</span>
                        <span class=
"nl">effectiveRange:</span><span class="o">&amp;</span><span class=
"n">range</span><span class="p">])</span>
<span class="p">{</span>
    <span class="c1">// Make underlined text blue as well</span>
    <span class="p">[</span><span class=
"n">mutableAttributedString</span> <span class=
"n">addAttribute</span><span class="o">:</span><span class=
"n">NSForegroundColorAttributeName</span>
                                    <span class=
"nl">value:</span><span class="p">[</span><span class=
"n">UIColor</span> <span class="n">blueColor</span><span class=
"p">]</span>
                                    <span class=
"nl">range:</span><span class="n">range</span><span class=
"p">];</span>
<span class="p">}</span>
</code>
</pre>
            </div>
            <h2>
              CFRange
            </h2>
            <p>
              One final caveat: Core Foundation also defines a
              <code>CFRange</code> type, which differs from
              <code>NSRange</code> in using <code>CFIndex</code>
              types for its members, and having only the function
              <code>CFRangeMake</code>:
            </p>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="k">typedef</span> <span class=
"k">struct</span> <span class="p">{</span>
    <span class="n">CFIndex</span> <span class=
"n">location</span><span class="p">;</span>
    <span class="n">CFIndex</span> <span class=
"n">length</span><span class="p">;</span>
<span class="p">}</span> <span class="n">CFRange</span><span class=
"p">;</span>
</code>
</pre>
            </div>
            <p>
              Anyone working with CoreText or another low-level C
              API is likely to encounter <code>CFRange</code> in
              place of <code>NSRange</code>.
            </p>
          </div>
          <aside>
            <a href="https://twitter.com/share" class=
            "twitter-share-button" data-url=
            "http://nshipster.com/nsrange/" data-via="NSHipster"
            data-size="large">Tweet</a> <script type=
            "text/javascript">
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
            </script>
          </aside>
          <footer id="book" class="promotion">
            <a href="https://gum.co/cfhipsterref"></a>
            <div id="cfhipsterref-cover"></div>
            <div>
              <hgroup>
                <h1>
                  <a href=
                  "https://gum.co/cfhipsterref">CFHipsterRef:
                  Low-Level Programming on<br>
                  iOS &amp; Mac OS X</a>
                </h1>
                <h2>
                  Available May 27th, 2014
                </h2>
              </hgroup>
              <p>
                Perfect for intermediate and expert developers
                wanting to take a deeper dive into advanced topics,
                <em>CFHipsterRef: Low-Level Programming on iOS
                &amp; Mac OS X</em> covers the core technologies
                powering Cocoa, Objective-C, and the operating
                system itself, including Core Bluetooth,
                Accelerate, and the Objective-C runtime.
              </p><button onclick=
              "javascript:window.location.href='https://gum.co/cfhipsterref'">Pre-Order
              Now</button>
            </div>
          </footer>
        </article>
      </div>
      <footer role="contentinfo">
        <section class="credits colophon">
          <p>
            Created by <a href="http://mattt.me">Mattt
            Thompson</a>, and released under a <a href=
            "http://creativecommons.org/licenses/by-nc/3.0/" rel=
            "license">Creative Commons BY-NC License</a>. <a href=
            "https://plus.google.com/106751358503565042647?rel=author"
            style="display: none;"></a>
          </p>
          <p>
            Articles also available in <a href=
            "http://nshipster.cn" hreflang="zh-Hans">中文</a>.
          </p>
        </section>
        <aside class="links">
          <a href="https://github.com/NSHipster/articles/issues"
          class="icon-github" title="Pull Requests Welcome"
          aria-hidden="true"></a> <a href="/feed.xml" class=
          "icon-feed" title="RSS" aria-hidden="true"></a>
        </aside>
        <section class="archive" role="navigation">
          <div>
            <h2>
              Foundation
            </h2>
            <ul>
              <li>
                <a href="/nsurl/">NSURL /<br>
                NSURLComponents</a>
              </li>
              <li>
                <a href=
                "/nstemporarydirectory/">NSTemporaryDirectory /<br>
                NSItemReplacementDirectory /<br>
                mktemp(3)</a>
              </li>
              <li>
                <a href="/nsrange/">NSRange</a>
              </li>
              <li>
                <a href=
                "/nsnotification-and-nsnotificationcenter/">NSNotification
                &amp;<br>
                NSNotificationCenter</a>
              </li>
              <li>
                <a href="/nsfilemanager/">NSFileManager</a>
              </li>
              <li>
                <a href="/nsformatter/">NSFormatter</a>
              </li>
              <li>
                <a href="/nserror/">NSError</a>
              </li>
              <li>
                <a href="/key-value-observing/">Key-Value
                Observing</a>
              </li>
              <li>
                <a href="/nshashtable-and-nsmaptable/">NSHashTable
                &amp;<br>
                NSMapTable</a>
              </li>
              <li>
                <a href="/nspredicate/">NSPredicate</a>
              </li>
              <li>
                <a href="/nsexpression/">NSExpression</a>
              </li>
              <li>
                <a href="/enumerators/">NSFastEnumeration /<br>
                NSEnumerator /<br>
                -enumerateObjectsUsingBlock:</a>
              </li>
              <li>
                <a href="/uuid-udid-unique-identifier/">NSUUID
                /<br>
                CFUUIDRef /<br>
                UIDevice -uniqueIdentifier /<br>
                -identifierForVendor</a>
              </li>
              <li>
                <a href="/nsdatadetector/">NSDataDetector</a>
              </li>
              <li>
                <a href="/nscoding/">NSCoding / NSKeyedArchiver</a>
              </li>
              <li>
                <a href="/nssecurecoding/">NSSecureCoding</a>
              </li>
              <li>
                <a href=
                "/nsassertionhandler/">NSAssertionHandler</a>
              </li>
              <li>
                <a href="/nsurlcache/">NSURLCache</a>
              </li>
              <li>
                <a href="/nsvalue/">NSValue</a>
              </li>
              <li>
                <a href="/nslocalizedstring/">NSLocalizedString</a>
              </li>
              <li>
                <a href="/instancetype/">instancetype</a>
              </li>
              <li>
                <a href="/kvc-collection-operators/">KVC Collection
                Operators</a>
              </li>
              <li>
                <a href="/nsorderedset/">NSOrderedSet</a>
              </li>
              <li>
                <a href="/ns_enum-ns_options/">NS_ENUM &amp;
                NS_OPTIONS</a>
              </li>
              <li>
                <a href=
                "/nsvaluetransformer/">NSValueTransformer</a>
              </li>
              <li>
                <a href="/nsurlprotocol/">NSURLProtocol</a>
              </li>
              <li>
                <a href=
                "/nslinguistictagger/">NSLinguisticTagger</a>
              </li>
              <li>
                <a href="/nscharacterset/">NSCharacterSet</a>
              </li>
              <li>
                <a href="/nslocale/">NSLocale</a>
              </li>
              <li>
                <a href="/nsoperation/">NSOperation</a>
              </li>
              <li>
                <a href=
                "/nsincrementalstore/">NSIncrementalStore</a>
              </li>
              <li>
                <a href="/nsdatecomponents/">NSDateComponents</a>
              </li>
              <li>
                <a href="/nssortdescriptor/">NSSortDescriptor</a>
              </li>
              <li>
                <a href="/nscache/">NSCache</a>
              </li>
              <li>
                <a href="/nsindexset/">NSIndexSet</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              CoreFoundation
            </h2>
            <ul>
              <li>
                <a href="/cfbag/">CFBag</a>
              </li>
              <li>
                <a href="/cfstringtransform/">CFStringTransform</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              CoreGraphics
            </h2>
            <ul>
              <li>
                <a href="/cggeometry/">CGGeometry</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              UIKit
            </h2>
            <ul>
              <li>
                <a href=
                "/launch-options/">UIApplicationDelegate<br>
                launchOptions</a>
              </li>
              <li>
                <a href="/uimenucontroller/">UIMenuController</a>
              </li>
              <li>
                <a href="/uiappearance/">UIAppearance</a>
              </li>
              <li>
                <a href=
                "/uilocalizedindexedcollation/">UILocalizedIndexedCollation</a>
              </li>
              <li>
                <a href="/uicollectionview/">UICollectionView</a>
              </li>
              <li>
                <a href="/uiaccessibility/">UIAccessibility</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              Objective-C
            </h2>
            <ul>
              <li>
                <a href="/namespacing/">Namespacing</a>
              </li>
              <li>
                <a href="/extended-file-attributes/">Extended File
                Attributes</a>
              </li>
              <li>
                <a href="/equality/">Equality</a>
              </li>
              <li>
                <a href="/random/">rand(3) / random(3) /
                arc4random(3) / et al.</a>
              </li>
              <li>
                <a href="/object-subscripting/">Object
                Subscripting</a>
              </li>
              <li>
                <a href="/bool/">BOOL / bool / Boolean /
                NSCFBoolean</a>
              </li>
              <li>
                <a href="/c-storage-classes/">C Storage Classes</a>
              </li>
              <li>
                <a href="/type-encodings/">Type Encodings</a>
              </li>
              <li>
                <a href="/__attribute__/">__attribute__</a>
              </li>
              <li>
                <a href="/nil/">nil / Nil / NULL / NSNull</a>
              </li>
              <li>
                <a href="/at-compiler-directives/">@</a>
              </li>
              <li>
                <a href="/pragma/">#pragma</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              Open Source
            </h2>
            <ul>
              <li>
                <a href="/xctool/">xctool</a>
              </li>
              <li>
                <a href="/afnetworking-2/">AFNetworking 2.0</a>
              </li>
              <li>
                <a href="/core-data-libraries-and-utilities/">Core
                Data Libraries &amp; Utilities</a>
              </li>
              <li>
                <a href="/gpuimage/">GPUImage</a>
              </li>
              <li>
                <a href="/reactivecocoa/">ReactiveCocoa</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              Testing
            </h2>
            <ul>
              <li>
                <a href="/unit-testing/">Unit Testing</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              Miscellanea
            </h2>
            <ul>
              <li>
                <a href=
                "/avspeechsynthesizer/">AVSpeechSynthesizer</a>
              </li>
              <li>
                <a href="/empathy/">Empathy</a>
              </li>
              <li>
                <a href=
                "/dictionary-services/">UIReferenceLibraryViewController
                /<br>
                DCSDictionaryRef/<br>
                /usr/share/dict/words</a>
              </li>
              <li>
                <a href="/method-swizzling/">Method Swizzling</a>
              </li>
              <li>
                <a href="/associated-objects/">Associated
                Objects</a>
              </li>
              <li>
                <a href=
                "/mktileoverlay-mkmapsnapshotter-mkdirections/">MKTileOverlay,<br>
                MKMapSnapshotter &amp;<br>
                MKDirections</a>
              </li>
              <li>
                <a href="/stewardship/">Stewardship</a>
              </li>
              <li>
                <a href="/colophon/">Colophon</a>
              </li>
              <li>
                <a href="/new-years-2014/">Reader Submissions -<br>
                New Year's 2014</a>
              </li>
              <li>
                <a href="/multipeer-connectivity/">Multipeer
                Connectivity</a>
              </li>
              <li>
                <a href="/nshipster-quiz-4/">NSHipster Quiz #4</a>
              </li>
              <li>
                <a href=
                "/launch-arguments-and-environment-variables/">Launch
                Arguments &amp;<br>
                Environment Variables</a>
              </li>
              <li>
                <a href="/xcode-key-bindings-and-gestures/">Xcode
                Key Bindings &amp; Gestures</a>
              </li>
              <li>
                <a href="/ios7/">iOS 7</a>
              </li>
              <li>
                <a href="/network-link-conditioner/">Network Link
                Conditioner</a>
              </li>
              <li>
                <a href="/xcode-snippets/">Xcode Snippets</a>
              </li>
              <li>
                <a href="/documentation/">Documentation</a>
              </li>
              <li>
                <a href="/nshipster-quiz-3/">NSHipster Quiz #3</a>
              </li>
              <li>
                <a href="/nshipster-quiz-2/">NSHipster Quiz #2</a>
              </li>
              <li>
                <a href="/mklocalsearch/">MKLocalSearch</a>
              </li>
              <li>
                <a href="/nshipster-quiz-1/">NSHipster Quiz #1</a>
              </li>
              <li>
                <a href="/icloud/">iCloud</a>
              </li>
              <li>
                <a href="/search-kit/">Search Kit</a>
              </li>
              <li>
                <a href="/backrow/">Back Row</a>
              </li>
              <li>
                <a href=
                "/reader-submissions-new-years-2013/">Reader
                Submissions -<br>
                New Year's 2013</a>
              </li>
              <li>
                <a href="/addressbookui/">AddressBookUI</a>
              </li>
            </ul>
          </div>
        </section>
      </footer>
    </div><script type="text/javascript">
var Swiftype = window.Swiftype || {};
    (function() {
      Swiftype.key = 'Q5jNBiR8qVs5xE5dNect';
      var script = document.createElement('script');
      script.type = 'text/javascript';
      script.async = true;
      script.src = "//swiftype.com/embed.js";
      var entry = document.getElementsByTagName('script')[0];
      document.getElementsByTagName('script')[0].parentNode.insertBefore(script, entry);
    }());
    </script><script type="text/javascript">
var _gauges = _gauges || [];
    (function() {
      var t   = document.createElement('script');
      t.type  = 'text/javascript';
      t.async = true;
      t.id    = 'gauges-tracker';
      t.setAttribute('data-site-id', '510be6d4108d7b438800005f');
      t.src = '//secure.gaug.es/track.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(t, s);
    })();
    </script>
  </body>
</html>
